---
phase: 21-vip-events-polish
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - maguey-nights/src/pages/EventPage.tsx
  - maguey-nights/public/robots.txt
  - maguey-nights/index.html
  - maguey-nights/public/sitemap.xml
autonomous: true

must_haves:
  truths:
    - "Marketing site shows empty state or error message when database query fails (no hardcoded events)"
    - "sitemap.xml exists in public directory with correct routes"
    - "robots.txt includes Sitemap directive pointing to sitemap.xml"
    - "index.html includes JSON-LD structured data for the organization"
  artifacts:
    - path: "maguey-nights/src/pages/EventPage.tsx"
      provides: "Event page without hardcoded fallbackEvents object"
    - path: "maguey-nights/public/sitemap.xml"
      provides: "XML sitemap with static marketing site routes"
      contains: "urlset"
    - path: "maguey-nights/public/robots.txt"
      provides: "robots.txt with Sitemap directive"
      contains: "Sitemap:"
    - path: "maguey-nights/index.html"
      provides: "JSON-LD Organization structured data"
      contains: "application/ld+json"
  key_links:
    - from: "maguey-nights/public/robots.txt"
      to: "maguey-nights/public/sitemap.xml"
      via: "Sitemap directive URL"
      pattern: "Sitemap:.*sitemap.xml"
---

<objective>
Remove hardcoded fallback events from the marketing site and add SEO basics (sitemap, robots, JSON-LD).

Purpose: EventPage.tsx contains a 90-line hardcoded `fallbackEvents` object that is declared but never used (dead code). The data/events.ts file is imported by 2 other files so cannot be deleted yet, but EventPage.tsx's local fallback must go. The marketing site also lacks sitemap.xml and JSON-LD structured data needed for search engine indexing.

Output: Clean EventPage.tsx without dead code, functional sitemap.xml, robots.txt with Sitemap directive, and Organization JSON-LD in index.html.
</objective>

<execution_context>
@/Users/luismiguel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/luismiguel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/milestones/v2.0-ROADMAP.md
@.planning/STATE.md
@.planning/phases/21-vip-events-polish/21-RESEARCH.md
@maguey-nights/src/pages/EventPage.tsx
@maguey-nights/public/robots.txt
@maguey-nights/index.html
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove hardcoded fallback events from EventPage.tsx</name>
  <files>
    maguey-nights/src/pages/EventPage.tsx
  </files>
  <action>
    1. In `maguey-nights/src/pages/EventPage.tsx`, delete the entire `fallbackEvents` object declaration (lines 83-173). This is a `const fallbackEvents = { ... }` that maps event slugs to hardcoded event data. It is declared but never referenced anywhere in the component -- the component uses `event` state from `fetchEventById()` for all rendering.

    2. Verify the deletion does not break anything by confirming:
       - The variable `fallbackEvents` is not used in any JSX or logic in EventPage.tsx
       - The component's data flow is: `useEffect -> fetchEventById(eventId) -> setEvent(eventData)` -- purely database-driven
       - The loading state shows a spinner, the error state shows "Event Not Found" -- both already handle the no-data case gracefully

    3. Also remove the unused image imports that were ONLY used by fallbackEvents. Check each import against remaining usage in the component:
       - `eventReggaeton` - used by fallbackEvents only? If so, remove the import
       - `eventChampagne` - used by fallbackEvents only? If so, remove the import
       - `eventFiesta` - used by fallbackEvents only? If so, remove the import
       - `venueMainstage` - used by fallbackEvents only? If so, remove the import
       - `venueVip` - used by fallbackEvents only? If so, remove the import
       - `venuePatio` - used by fallbackEvents only? If so, remove the import
       - `social1` - used by fallbackEvents only? If so, remove the import
       - `social2` - used by fallbackEvents only? If so, remove the import

       To check: search the file for each variable name OUTSIDE the fallbackEvents block. If not found elsewhere, remove the import.

    4. Note: The `vipTables` array (lines ~176-281) is still used by the seating tab JSX and should NOT be removed. Only remove `fallbackEvents` and its unused imports.

    5. Note: `maguey-nights/src/data/events.ts` is imported by `src/admin/EventManager.tsx` and `src/pages/Checkout.tsx` -- do NOT delete this file. The requirement R29 is about removing hardcoded FALLBACK events (the ones in EventPage.tsx that show when DB fails), not the legacy data file. The data file is a separate Phase 22 cleanup concern.
  </action>
  <verify>
    - `grep -n "fallbackEvents" maguey-nights/src/pages/EventPage.tsx` returns NO matches
    - `cd maguey-nights && npm run build` succeeds without errors or warnings about unused imports
    - The component still has its loading state (Loader2), error state ("Event Not Found"), and database-driven rendering
  </verify>
  <done>
    - fallbackEvents object removed from EventPage.tsx (90 lines of dead code deleted)
    - Unused image imports cleaned up
    - Component data flow remains purely database-driven via fetchEventById
    - Build succeeds with no regressions
  </done>
</task>

<task type="auto">
  <name>Task 2: Add sitemap.xml, robots.txt Sitemap directive, and JSON-LD</name>
  <files>
    maguey-nights/public/sitemap.xml
    maguey-nights/public/robots.txt
    maguey-nights/index.html
  </files>
  <action>
    1. Create `maguey-nights/public/sitemap.xml` with static marketing site routes:
       ```xml
       <?xml version="1.0" encoding="UTF-8"?>
       <urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
         <url>
           <loc>https://magueynightclub.com/</loc>
           <changefreq>weekly</changefreq>
           <priority>1.0</priority>
         </url>
         <url>
           <loc>https://magueynightclub.com/upcoming-events</loc>
           <changefreq>weekly</changefreq>
           <priority>0.9</priority>
         </url>
         <url>
           <loc>https://magueynightclub.com/restaurant</loc>
           <changefreq>monthly</changefreq>
           <priority>0.8</priority>
         </url>
         <url>
           <loc>https://magueynightclub.com/gallery</loc>
           <changefreq>monthly</changefreq>
           <priority>0.7</priority>
         </url>
         <url>
           <loc>https://magueynightclub.com/contact</loc>
           <changefreq>monthly</changefreq>
           <priority>0.6</priority>
         </url>
         <url>
           <loc>https://magueynightclub.com/about-us</loc>
           <changefreq>monthly</changefreq>
           <priority>0.6</priority>
         </url>
         <url>
           <loc>https://magueynightclub.com/careers</loc>
           <changefreq>monthly</changefreq>
           <priority>0.5</priority>
         </url>
         <url>
           <loc>https://magueynightclub.com/faq</loc>
           <changefreq>monthly</changefreq>
           <priority>0.5</priority>
         </url>
         <url>
           <loc>https://magueynightclub.com/policies</loc>
           <changefreq>yearly</changefreq>
           <priority>0.3</priority>
         </url>
       </urlset>
       ```
       Note: Event detail pages (/events/:id) are dynamic and would require build-time generation from the database. For v1, the static sitemap covers the main pages. Dynamic event sitemaps can be added via a Vercel serverless function or build script in Phase 23.

    2. Update `maguey-nights/public/robots.txt` to add a Sitemap directive. Keep all existing content and append at the end:
       ```
       Sitemap: https://magueynightclub.com/sitemap.xml
       ```

    3. Add Organization JSON-LD structured data to `maguey-nights/index.html`. Insert a `<script type="application/ld+json">` block inside the `<head>`, BEFORE the closing `</head>` tag (after the existing meta tags but before the style block):
       ```html
       <script type="application/ld+json">
       {
         "@context": "https://schema.org",
         "@type": "NightClub",
         "name": "Maguey Nightclub",
         "description": "Delaware's premier Latin-inspired nightclub featuring premium bottle service, world-class DJs, and unforgettable nights.",
         "url": "https://magueynightclub.com",
         "telephone": "+13028888888",
         "address": {
           "@type": "PostalAddress",
           "streetAddress": "3320 Old Capitol Trail",
           "addressLocality": "Wilmington",
           "addressRegion": "DE",
           "postalCode": "19808",
           "addressCountry": "US"
         },
         "geo": {
           "@type": "GeoCoordinates",
           "latitude": 39.7447,
           "longitude": -75.6243
         },
         "openingHoursSpecification": [
           {
             "@type": "OpeningHoursSpecification",
             "dayOfWeek": ["Friday", "Saturday"],
             "opens": "21:00",
             "closes": "03:00"
           }
         ],
         "sameAs": [
           "https://www.instagram.com/magueynightclub",
           "https://www.facebook.com/magueynightclub"
         ],
         "image": "/images/branding/maguey-logo.jpg",
         "priceRange": "$$"
       }
       </script>
       ```
       Use "NightClub" as the @type (it's a valid Schema.org type, subclass of EntertainmentBusiness).

       Note: Per-event MusicEvent JSON-LD would ideally be rendered dynamically by EventPage.tsx using react-helmet-async. However, react-helmet-async is not installed and adding it is outside scope. The Organization-level JSON-LD in index.html gives Google the venue info it needs for local search results. Per-event structured data can be added when react-helmet-async is installed in a future phase.
  </action>
  <verify>
    - `cat maguey-nights/public/sitemap.xml | head -3` shows valid XML with urlset
    - `grep "Sitemap:" maguey-nights/public/robots.txt` shows the directive
    - `grep "application/ld+json" maguey-nights/index.html` shows the JSON-LD script tag
    - `cd maguey-nights && npm run build` succeeds
    - Verify sitemap.xml and robots.txt appear in the build output: `ls maguey-nights/dist/sitemap.xml maguey-nights/dist/robots.txt`
  </verify>
  <done>
    - sitemap.xml created with 9 static marketing site routes
    - robots.txt updated with Sitemap directive
    - index.html has Organization/NightClub JSON-LD with address, hours, social links
    - All files copied to dist/ on build (Vite copies public/ to dist/)
  </done>
</task>

</tasks>

<verification>
- No hardcoded fallback events in EventPage.tsx
- sitemap.xml, robots.txt, and JSON-LD all present and valid
- Build succeeds: `cd maguey-nights && npm run build`
- robots.txt in dist/ has Sitemap directive
- sitemap.xml in dist/ has 9 URLs
</verification>

<success_criteria>
- Marketing site shows empty state (not hardcoded events) when DB query fails -- verified by EventPage.tsx error handling and UpcomingEvents.tsx empty state (already working)
- sitemap.xml present with marketing site routes
- robots.txt has Sitemap directive
- JSON-LD NightClub structured data in index.html
</success_criteria>

<output>
After completion, create `.planning/phases/21-vip-events-polish/21-03-SUMMARY.md`
</output>
